#include "crypto_hashblocks/sha512/ref0/sha512_blocks.jazz"

export fn sha512_blocks_ref0(reg u64 pH in _inlen) -> reg u64
{
  stack u64[8] H;
  stack u64 pHs;
  reg u64 inlen;

  // load H
  H = load_H_mem(pH); pHs = pH;

  // swap inlen register
  inlen = _inlen;
  H, in, inlen = _sha512_blocks_ref0(H, in, inlen);

  // restore pointer
  pH = pHs;
  store_H_mem(pH, H);

  return inlen;
}
