#include "crypto_hashblocks/sha256/inplace/sha256_blocks.jazz"

export fn sha256_blocks_inplace(reg u64 pH in _inlen) -> reg u64
{
  stack u32[8] H;
  stack u64 pHs;
  reg u64 inlen;

  // load H
  H = load_H_mem(pH); pHs = pH;

  // swap inlen register
  inlen = _inlen;
  H, in, inlen = _sha256_blocks_inplace(H, in, inlen);

  // restore pointer
  pH = pHs;
  store_H_mem(pH, H);

  return inlen;
}
