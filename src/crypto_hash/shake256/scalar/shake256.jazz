#ifndef CRYPTO_HASH_SHAKE256_SCALAR
#define CRYPTO_HASH_SHAKE256_SCALAR

#include "crypto_hash/keccak1600/scalar/keccak1600.jazz"

inline fn __shake256_scalar(reg u64 out outlen in inlen)
{
  reg u64 rate;
  reg u8 trail_byte;

  trail_byte = 0x1F;
  rate = (1088/8);

  __keccak1600_scalar(out, outlen, in, inlen, trail_byte, rate);
}

#ifdef EXPORT

export fn shake256_scalar(reg u64 out outlen in inlen)
{
  __shake256_scalar(out, outlen, in, inlen);
}

#endif

#endif
